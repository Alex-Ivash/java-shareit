CREATE TABLE IF NOT EXISTS "users" (
  "id" BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  "email" VARCHAR(255) UNIQUE NOT NULL,
  "name" TEXT NOT NULL
);

CREATE TABLE IF NOT EXISTS "items" (
  "id" BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  "name" TEXT NOT NULL,
  "description" TEXT,
  "available" BOOLEAN NOT NULL,
  "owner_id" BIGINT NOT NULL
);

CREATE TABLE IF NOT EXISTS "bookings" (
  "id" BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  "item_id" BIGINT NOT NULL,
  "booker_id" BIGINT NOT NULL,
  "start_date_time" TIMESTAMP WITHOUT TIME ZONE NOT NULL,
  "end_date_time" TIMESTAMP WITHOUT TIME ZONE NOT NULL,
  "status" VARCHAR(255) NOT NULL
);

CREATE TABLE IF NOT EXISTS "comments" (
  "id" BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  "text" TEXT NOT NULL,
  "item_id" BIGINT NOT NULL,
  "author_id" BIGINT NOT NULL,
  "created" TIMESTAMP WITHOUT TIME ZONE NOT NULL
);

ALTER TABLE "items" ADD FOREIGN KEY ("owner_id") REFERENCES "users" ("id") ON DELETE CASCADE;

ALTER TABLE "bookings" ADD FOREIGN KEY ("booker_id") REFERENCES "users" ("id") ON DELETE CASCADE;

ALTER TABLE "bookings" ADD FOREIGN KEY ("item_id") REFERENCES "items" ("id") ON DELETE CASCADE;

ALTER TABLE "comments" ADD FOREIGN KEY ("item_id") REFERENCES "items" ("id") ON DELETE CASCADE;

ALTER TABLE "comments" ADD FOREIGN KEY ("author_id") REFERENCES "users" ("id") ON DELETE CASCADE;
